<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnostyka CBCT w Endodoncji - Gra Edukacyjna</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2980b9;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
            --text: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            padding: 20px;
        }
        
        h1, h2, h3 {
            color: var(--dark);
            margin-bottom: 15px;
        }
        
        button {
            background-color: var(--primary);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin: 5px;
            padding: 10px 15px;
            text-transform: uppercase;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: var(--secondary);
        }
        
        button.correct {
            background-color: var(--success);
        }
        
        button.incorrect {
            background-color: var(--danger);
        }
        
        button.active {
            background-color: var(--secondary);
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        }
        
        input[type="radio"] {
            margin-right: 10px;
        }
        
        .container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
            max-width: 1200px;
            padding: 20px;
        }
        
        .header {
            border-bottom: 2px solid var(--light);
            margin-bottom: 20px;
            padding-bottom: 20px;
            text-align: center;
        }
        
        .main {
            display: flex;
            flex-direction: column;
            min-height: 500px;
        }
        
        .section {
            margin-bottom: 20px;
        }
        
        #welcome-screen, #game-screen, #results-screen {
            display: none;
        }
        
        #welcome-screen.active, #game-screen.active, #results-screen.active {
            display: block;
        }
        
        .progress-bar {
            background-color: var(--light);
            border-radius: 4px;
            height: 20px;
            margin: 20px 0;
            overflow: hidden;
            width: 100%;
        }
        
        .progress {
            background-color: var(--primary);
            height: 100%;
            transition: width 0.3s ease;
            width: 0;
        }
        
        .case-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .view-buttons {
            display: flex;
            justify-content: center;
            margin: 15px 0;
        }
        
        .imaging-container {
            display: flex;
            gap: 20px;
            justify-content: space-between;
            margin: 20px 0;
        }
        
        .imaging-view {
            border: 1px solid var(--light);
            border-radius: 4px;
            flex: 1;
            padding: 10px;
            text-align: center;
        }
        
        .svg-container {
            margin: 0 auto;
            max-width: 300px;
        }
        
        svg {
            max-width: 100%;
        }
        
        .options-container {
            margin: 20px 0;
        }
        
        .option {
            background-color: white;
            border: 1px solid var(--light);
            border-radius: 4px;
            margin-bottom: 10px;
            padding: 10px;
        }
        
        .feedback {
            background-color: var(--light);
            border-radius: 4px;
            margin-top: 20px;
            padding: 15px;
        }
        
        .info-panel {
            background-color: var(--light);
            border-left: 4px solid var(--primary);
            margin: 20px 0;
            padding: 15px;
        }
        
        .summary {
            margin: 20px 0;
        }
        
        .score {
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            text-align: center;
        }
        
        .cases-list {
            list-style-type: none;
        }
        
        .cases-list li {
            border-bottom: 1px solid var(--light);
            padding: 10px 0;
        }
        
        .cases-list li span {
            display: inline-block;
            margin-left: 10px;
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .legend-item {
            align-items: center;
            display: flex;
            margin-right: 15px;
        }
        
        .legend-color {
            border: 1px solid #999;
            display: inline-block;
            height: 15px;
            margin-right: 5px;
            width: 15px;
        }
        
        @media (max-width: 768px) {
            .imaging-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Diagnostyka CBCT w Endodoncji</h1>
            <p>Gra edukacyjna do nauki diagnozowania zmian w badaniach tomografii stożkowej</p>
        </div>
        
        <div class="main">
            <div id="welcome-screen" class="active">
                <h2>Witaj w grze diagnostycznej CBCT!</h2>
                <div class="info-panel">
                    <h3>Instrukcje:</h3>
                    <p>Ta gra pomoże Ci w nauce diagnozowania zmian endodontycznych widocznych w badaniach CBCT w trzech płaszczyznach przestrzennych.</p>
                    <ul>
                        <li>Dla każdego przypadku zobaczysz obrazy w trzech płaszczyznach: osiowej, strzałkowej i czołowej</li>
                        <li>Twoim zadaniem jest przeanalizować zmiany widoczne na obrazach i postawić prawidłową diagnozę</li>
                        <li>Wybierz poprawne odpowiedzi z dostępnych opcji</li>
                        <li>Po każdym przypadku otrzymasz informację zwrotną z wyjaśnieniem</li>
                        <li>Na koniec otrzymasz podsumowanie wyników</li>
                    </ul>
                </div>
                <div class="legend">
                    <h3>Legenda obrazów CBCT:</h3>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: white;"></div>
                        <span>Powietrze/Puste przestrzenie</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #bbb;"></div>
                        <span>Tkanki miękkie</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #777;"></div>
                        <span>Zębina</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #444;"></div>
                        <span>Szkliwo</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #999;"></div>
                        <span>Kość</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ddd;"></div>
                        <span>Zmiany patologiczne</span>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button id="start-game">ROZPOCZNIJ GRĘ</button>
                </div>
            </div>
            
            <div id="game-screen">
                <div class="progress-bar">
                    <div class="progress" id="progress-bar"></div>
                </div>
                
                <h2 id="case-title">Przypadek 1</h2>
                <p id="case-description">Opis przypadku...</p>
                
                <div class="view-buttons">
                    <button id="view-all" class="active">Wszystkie widoki</button>
                    <button id="view-axial">Widok osiowy</button>
                    <button id="view-sagittal">Widok strzałkowy</button>
                    <button id="view-coronal">Widok czołowy</button>
                </div>
                
                <div class="imaging-container">
                    <div class="imaging-view" id="axial-view">
                        <h3>Widok osiowy (poziomy)</h3>
                        <div class="svg-container" id="axial-svg-container">
                            <!-- SVG obrazy będą wstawiane dynamicznie -->
                        </div>
                    </div>
                    
                    <div class="imaging-view" id="sagittal-view">
                        <h3>Widok strzałkowy</h3>
                        <div class="svg-container" id="sagittal-svg-container">
                            <!-- SVG obrazy będą wstawiane dynamicznie -->
                        </div>
                    </div>
                    
                    <div class="imaging-view" id="coronal-view">
                        <h3>Widok czołowy</h3>
                        <div class="svg-container" id="coronal-svg-container">
                            <!-- SVG obrazy będą wstawiane dynamicznie -->
                        </div>
                    </div>
                </div>
                
                <div class="options-container">
                    <h3>Diagnoza:</h3>
                    <div id="diagnosis-options">
                        <!-- Opcje diagnozy będą wstawiane dynamicznie -->
                    </div>
                </div>
                
                <div class="options-container">
                    <h3>Jakie zmiany obserwujesz?</h3>
                    <div id="findings-options">
                        <!-- Opcje obserwacji będą wstawiane dynamicznie -->
                    </div>
                </div>
                
                <div class="options-container">
                    <h3>Zalecane leczenie:</h3>
                    <div id="treatment-options">
                        <!-- Opcje leczenia będą wstawiane dynamicznie -->
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button id="submit-answer">ZATWIERDŹ ODPOWIEDŹ</button>
                </div>
                
                <div id="feedback" class="feedback" style="display: none;">
                    <h3>Informacja zwrotna:</h3>
                    <div id="feedback-content"></div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button id="next-case">NASTĘPNY PRZYPADEK</button>
                    </div>
                </div>
            </div>
            
            <div id="results-screen">
                <h2>Podsumowanie wyników</h2>
                <div class="score" id="final-score">Wynik: 0/0</div>
                <div class="summary">
                    <h3>Podsumowanie przypadków:</h3>
                    <ul class="cases-list" id="cases-summary">
                        <!-- Lista przypadków będzie wstawiana dynamicznie -->
                    </ul>
                </div>
                <div class="info-panel">
                    <h3>Wskazówki do dalszej nauki:</h3>
                    <p>Zwróć szczególną uwagę na następujące aspekty diagnozy endodontycznej w CBCT:</p>
                    <ul>
                        <li>Ocena anatomii kanałów korzeniowych</li>
                        <li>Identyfikacja dodatkowych kanałów</li>
                        <li>Rozpoznawanie resorpcji korzeni (wewnętrznej i zewnętrznej)</li>
                        <li>Diagnostyka złamań korzeni</li>
                        <li>Ocena zmian okołowierzchołkowych</li>
                        <li>Analiza perforacji</li>
                    </ul>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button id="restart-game">ZAGRAJ PONOWNIE</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Definicje przypadków
        const cases = [
            {
                id: 1,
                title: "Przypadek 1: Ząb 36 - Ból przy żuciu",
                description: "Pacjent, 45 lat, zgłasza się z bólem w okolicy zęba 36, który nasila się podczas żucia. Ząb reaguje nadwrażliwie na bodźce termiczne. W wywiadzie leczenie kanałowe w przeszłości.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <path d="M70 100 Q100 70 130 100 Q160 130 130 160 Q100 190 70 160 Q40 130 70 100" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="85" cy="115" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="115" cy="115" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="100" cy="85" r="8" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="100" cy="100" r="20" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <circle cx="120" cy="150" r="15" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="60" y="160" width="80" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="70" y="60" width="60" height="70" rx="1" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <circle cx="100" cy="175" r="12" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="70" y1="120" x2="130" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="70" y="130" width="60" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <ellipse cx="100" cy="80" rx="30" ry="10" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <path d="M85 160 Q100 190 115 160" fill="none" stroke="#ddd" stroke-width="3" />
                        <circle cx="100" cy="175" r="12" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Odwracalne zapalenie miazgi", correct: false },
                    { id: "d2", text: "Nieodwracalne zapalenie miazgi", correct: false },
                    { id: "d3", text: "Martwica miazgi", correct: false },
                    { id: "d4", text: "Przewlekłe zapalenie tkanek okołowierzchołkowych", correct: true },
                    { id: "d5", text: "Ostre zapalenie tkanek okołowierzchołkowych", correct: false }
                ],
                findingsOptions: [
                    { id: "f1", text: "Widoczne wypełnienie kanałowe", correct: true },
                    { id: "f2", text: "Rozrzedzenie kości w okolicy wierzchołka korzenia", correct: true },
                    { id: "f3", text: "Złamanie korzenia", correct: false },
                    { id: "f4", text: "Niewypełniony kanał dodatkowy", correct: true },
                    { id: "f5", text: "Resorpcja zewnętrzna korzenia", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Leczenie zachowawcze - obserwacja", correct: false },
                    { id: "t2", text: "Pierwotne leczenie kanałowe", correct: false },
                    { id: "t3", text: "Powtórne leczenie kanałowe", correct: true },
                    { id: "t4", text: "Hemisekcja korzenia", correct: false },
                    { id: "t5", text: "Ekstrakcja zęba", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek pokazuje przewlekłe zapalenie tkanek okołowierzchołkowych widoczne jako rozrzedzenie kości w okolicy wierzchołka korzenia.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>W kanałach widoczne jest wypełnienie kanałowe, ale jest ono niepełne</li>
                        <li>W widoku osiowym widać dodatkowy, niewypełniony kanał dystalny</li>
                        <li>Wokół wierzchołka korzenia widoczne jest rozrzedzenie kości sugerujące przewlekły stan zapalny</li>
                    </ul>
                    <p>Najlepszym rozwiązaniem jest ponowne leczenie kanałowe, które uwzględni niewypełniony kanał dodatkowy. To powinno wyeliminować źródło infekcji i umożliwić gojenie zmiany okołowierzchołkowej.</p>
                `
            },
            {
                id: 2,
                title: "Przypadek 2: Ząb 21 - Przebarwienie korony",
                description: "Pacjentka, 28 lat, zgłasza przebarwienie korony zęba 21. Badanie wykazuje brak reakcji na testy wrażliwości miazgi. W wywiadzie uraz tej okolicy 3 lata temu.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <circle cx="100" cy="100" r="20" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="100" cy="100" r="8" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <path d="M92 92 L108 108 M108 92 L92 108" stroke="#aaa" stroke-width="2" />
                        <ellipse cx="100" cy="130" rx="15" ry="8" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                        <path d="M90 80 Q100 75 110 80" fill="none" stroke="#c00" stroke-width="1" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <path d="M80 90 Q100 87 120 90" fill="none" stroke="#c00" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="80" y="160" width="40" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="90" y="70" width="20" height="90" rx="1" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <circle cx="100" cy="175" r="12" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                        <ellipse cx="100" cy="130" rx="10" ry="5" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="85" y1="120" x2="115" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="85" y="130" width="30" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <ellipse cx="100" cy="80" rx="15" ry="10" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <circle cx="100" cy="175" r="12" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                        <path d="M95 70 Q100 85 105 70" fill="none" stroke="#c66" stroke-width="2" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Martwica miazgi", correct: true },
                    { id: "d2", text: "Resorpcja wewnętrzna korzenia", correct: true },
                    { id: "d3", text: "Złamanie korzenia", correct: false },
                    { id: "d4", text: "Przewlekłe zapalenie tkanek okołowierzchołkowych", correct: true },
                    { id: "d5", text: "Pionowe złamanie korzenia", correct: false }
                ],
                findingsOptions: [
                    { id: "f1", text: "Poszerzenie kanału w części koronowej", correct: true },
                    { id: "f2", text: "Rozrzedzenie kości w okolicy wierzchołka korzenia", correct: true },
                    { id: "f3", text: "Złamanie korony zęba", correct: false },
                    { id: "f4", text: "Widoczna linia złamania", correct: false },
                    { id: "f5", text: "Zwężenie kanału korzeniowego", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Leczenie zachowawcze - obserwacja", correct: false },
                    { id: "t2", text: "Leczenie kanałowe", correct: true },
                    { id: "t3", text: "Leczenie chirurgiczne - resekcja wierzchołka", correct: false },
                    { id: "t4", text: "Rewizja leczenia kanałowego", correct: false },
                    { id: "t5", text: "Ekstrakcja zęba", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia resorpcję wewnętrzną korzenia z martwicą miazgi i przewlekłym zapaleniem tkanek okołowierzchołkowych.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Widoczne poszerzenie kanału w części koronowej - charakterystyczny objaw resorpcji wewnętrznej</li>
                        <li>Przebarwienie korony związane z martwicą miazgi po urazie</li>
                        <li>Rozrzedzenie kości przy wierzchołku korzenia wskazujące na przewlekłe zapalenie okolowierzchołkowe</li>
                    </ul>
                    <p>Resorpcja wewnętrzna to proces niszczenia zębiny od wewnątrz przez komórki zapalne (osteoklasty). Najczęściej jest skutkiem urazu zęba i wiąże się z zapaleniem miazgi.</p>
                    <p>Leczenie kanałowe jest postępowaniem z wyboru - należy dokładnie opracować poszerzony kanał oraz wypełnić go, co zatrzyma proces resorpcji.</p>
                `
            },
            {
                id: 3,
                title: "Przypadek 3: Ząb 46 - Nawracający ból",
                description: "Pacjent, 52 lata, zgłasza nawracający ból zęba 46, który był leczony kanałowo 5 lat temu. Ząb jest wrażliwy na nagryzanie.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <path d="M70 70 Q100 40 130 70 Q160 100 130 130 Q100 160 70 130 Q40 100 70 70" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="85" cy="85" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="115" cy="85" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="85" cy="115" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="115" cy="115" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <path d="M115 115 L130 130" fill="none" stroke="#ddd" stroke-width="2" stroke-dasharray="2" />
                        <ellipse cx="140" cy="140" rx="10" ry="10" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="60" y="160" width="80" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="70" y="60" width="60" height="70" rx="1" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <path d="M120 130 L140 150" fill="none" stroke="#ddd" stroke-width="2" stroke-dasharray="2" />
                        <circle cx="145" cy="155" r="10" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="70" y1="120" x2="130" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="70" y="130" width="60" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <ellipse cx="100" cy="80" rx="30" ry="10" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <path d="M125 140 L135 120 L145 140" fill="none" stroke="#f00" stroke-width="1" />
                        <path d="M130 160 L150 140" fill="none" stroke="#ddd" stroke-width="2" stroke-dasharray="2" />
                        <circle cx="155" cy="135" r="10" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Źle wypełnione kanały korzeniowe", correct: true },
                    { id: "d2", text: "Złamanie instrumentu endodontycznego", correct: false },
                    { id: "d3", text: "Pionowe złamanie korzenia", correct: true },
                    { id: "d4", text: "Przewlekłe zapalenie tkanek okołowierzchołkowych", correct: true },
                    { id: "d5", text: "Torbiel korzeniowa", correct: false }
                ],
                findingsOptions: [
                    { id: "f1", text: "Niewypełniony kanał boczny", correct: true },
                    { id: "f2", text: "Rozrzedzenie kości w okolicy furkacji", correct: false },
                    { id: "f3", text: "Rozrzedzenie kości wzdłuż dystalnego korzenia", correct: true },
                    { id: "f4", text: "Linia złamania biegnąca wzdłuż korzenia", correct: true },
                    { id: "f5", text: "Złamany instrument w kanale", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Rewizja leczenia kanałowego", correct: false },
                    { id: "t2", text: "Leczenie chirurgiczne - resekcja wierzchołka", correct: false },
                    { id: "t3", text: "Hemisekcja korzenia", correct: true },
                    { id: "t4", text: "Ekstrakcja zęba", correct: true },
                    { id: "t5", text: "Obserwacja i leczenie farmakologiczne", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia pionowe złamanie korzenia z przewlekłym zapaleniem tkanek okołowierzchołkowych, dodatkowo z niewypełnionym kanałem bocznym.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Widoczna linia złamania biegnąca wzdłuż dystalnego korzenia</li>
                        <li>Charakterystyczne rozrzedzenie kości wzdłuż linii złamania korzenia</li>
                        <li>Niewypełniony kanał boczny, który mógł przyczynić się do rozwoju stanu zapalnego</li>
                    </ul>
                    <p>Pionowe złamanie korzenia to poważne powikłanie, które często występuje w zębach po leczeniu kanałowym. Rokowanie jest zwykle niepomyślne.</p>
                    <p>W zależności od zasięgu złamania i preferencji pacjenta można rozważyć:</p>
                    <ul>
                        <li>Hemisekcję korzenia - usunięcie złamanej części z zachowaniem reszty zęba (jeśli złamanie dotyczy tylko jednego korzenia)</li>
                        <li>Ekstrakcję całego zęba (zwłaszcza jeśli złamanie obejmuje większy obszar)</li>
                    </ul>
                `
            },
            {
                id: 4,
                title: "Przypadek 4: Ząb 13 - Opuchnięcie dziąsła",
                description: "Pacjentka, 34 lata, zgłasza się z opuchnięciem dziąsła w okolicy zęba 13. Ząb nie reaguje na testy wrażliwości miazgi. Widoczna jest przetoka na błonie śluzowej.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <circle cx="100" cy="100" r="15" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="100" cy="100" r="6" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <path d="M100 100 L130 130" fill="none" stroke="#ddd" stroke-width="2" stroke-dasharray="2" />
                        <circle cx="140" cy="140" r="15" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                        <path d="M135 80 Q150 100 135 120" fill="none" stroke="#bbb" stroke-width="3" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="80" y="160" width="40" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="90" y="70" width="20" height="90" rx="1" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="100" cy="180" r="15" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                        <path d="M60 120 Q80 130 100 120" fill="none" stroke="#bbb" stroke-width="3" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="85" y1="120" x2="115" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="85" y="130" width="30" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <path d="M100 130 L140 130" fill="none" stroke="#ddd" stroke-width="2" stroke-dasharray="2" />
                        <circle cx="150" cy="130" r="15" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                        <ellipse cx="100" cy="80" rx="15" ry="10" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <path d="M120 50 Q140 80 120 110" fill="none" stroke="#bbb" stroke-width="3" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Martwica miazgi", correct: true },
                    { id: "d2", text: "Ropień okołowierzchołkowy", correct: true },
                    { id: "d3", text: "Torbiel korzeniowa", correct: false },
                    { id: "d4", text: "Zapalenie dziąseł", correct: false },
                    { id: "d5", text: "Resorpcja zewnętrzna korzenia", correct: false }
                ],
                findingsOptions: [
                    { id: "f1", text: "Rozrzedzenie kości w okolicy wierzchołka korzenia", correct: true },
                    { id: "f2", text: "Droga przetoki od wierzchołka do błony śluzowej", correct: true },
                    { id: "f3", text: "Poszerzona szpara ozębnej", correct: true },
                    { id: "f4", text: "Złamanie korzenia", correct: false },
                    { id: "f5", text: "Obliteracja kanału korzeniowego", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Leczenie zachowawcze - drenaż", correct: false },
                    { id: "t2", text: "Leczenie kanałowe", correct: true },
                    { id: "t3", text: "Antybiotykoterapia bez leczenia kanałowego", correct: false },
                    { id: "t4", text: "Resekcja wierzchołka korzenia", correct: false },
                    { id: "t5", text: "Ekstrakcja zęba", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia martwicę miazgi z ropniem okołowierzchołkowym i drogą przetoki.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Wyraźne rozrzedzenie kości w okolicy wierzchołka korzenia zęba 13</li>
                        <li>Widoczna droga przetoki od wierzchołka korzenia do błony śluzowej</li>
                        <li>Poszerzona szpara ozębnej wokół wierzchołka, wskazująca na stan zapalny</li>
                    </ul>
                    <p>Przetoka jest drogą drenażu ropnia okołowierzchołkowego. Obecność przetoki często zmniejsza ból, ponieważ zapewnia ujście dla wydzieliny ropnej i zmniejsza ciśnienie w tkankach.</p>
                    <p>Leczenie kanałowe jest postępowaniem z wyboru. Mimo że antybiotykoterapia może tymczasowo złagodzić objawy, nie eliminuje przyczyny infekcji, którą jest martwica miazgi. Tylko leczenie kanałowe może skutecznie usunąć zakażoną miazgę i umożliwić gojenie tkanek okołowierzchołkowych.</p>
                `
            },
            {
                id: 5,
                title: "Przypadek 5: Ząb 17 - Bolesność przy nagryzaniu",
                description: "Pacjent, 48 lat, zgłasza ból przy nagryzaniu na ząb 17. Na zdjęciu RTG widoczne wypełnienie kanałowe wykonane 2 lata temu.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <path d="M70 70 Q100 40 130 70 Q160 100 130 130 Q100 160 70 130 Q40 100 70 70" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="85" cy="85" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="115" cy="85" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="85" cy="115" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <ellipse cx="125" cy="115" rx="20" ry="10" fill="#fff" stroke="#ddd" stroke-width="1" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="60" y="160" width="80" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="70" y="60" width="60" height="70" rx="1" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <circle cx="100" cy="175" r="10" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                        <path d="M120 110 L130 130" fill="none" stroke="#f00" stroke-width="1" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="70" y1="120" x2="130" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="70" y="130" width="60" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <ellipse cx="100" cy="80" rx="30" ry="10" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <path d="M110 140 L130 120" fill="none" stroke="#f00" stroke-width="1" />
                        <ellipse cx="125" cy="110" rx="15" ry="5" fill="#fff" stroke="#ddd" stroke-width="1" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Perforacja korzenia", correct: false },
                    { id: "d2", text: "Złamanie instrumentu endodontycznego", correct: false },
                    { id: "d3", text: "Pionowe złamanie korzenia", correct: true },
                    { id: "d4", text: "Przepchnięte wypełnienie kanałowe", correct: false },
                    { id: "d5", text: "Niepełne wypełnienie kanałowe", correct: false }
                ],
                findingsOptions: [
                    { id: "f1", text: "Linia złamania biegnąca od kanału do powierzchni korzenia", correct: true },
                    { id: "f2", text: "Przejaśnienie wzdłuż bocznej powierzchni korzenia", correct: true },
                    { id: "f3", text: "Nieprawidłowe wypełnienie kanałowe", correct: false },
                    { id: "f4", text: "Złamany instrument w kanale", correct: false },
                    { id: "f5", text: "Nadmiar materiału wypełniającego poza wierzchołkiem", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Rewizja leczenia kanałowego", correct: false },
                    { id: "t2", text: "Leczenie chirurgiczne - resekcja wierzchołka", correct: false },
                    { id: "t3", text: "Ekstrakcja zęba", correct: true },
                    { id: "t4", text: "Hemisekcja korzenia", correct: false },
                    { id: "t5", text: "Obserwacja i leczenie farmakologiczne", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia pionowe złamanie korzenia w zębie po leczeniu kanałowym.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Widoczna linia złamania biegnąca od kanału korzeniowego do powierzchni korzenia</li>
                        <li>Charakterystyczne przejaśnienie (rozrzedzenie kości) wzdłuż bocznej powierzchni korzenia</li>
                        <li>Brak innych nieprawidłowości w leczeniu kanałowym</li>
                    </ul>
                    <p>Pionowe złamanie korzenia jest poważnym powikłaniem, które najczęściej występuje w zębach po leczeniu kanałowym. Zęby trzonowe i przedtrzonowe są szczególnie narażone ze względu na siły żucia.</p>
                    <p>Ekstrakcja zęba jest zazwyczaj jedynym realnym rozwiązaniem w przypadku pionowego złamania korzenia, zwłaszcza gdy złamanie obejmuje znaczną część korzenia. Rokowanie dla zachowania takiego zęba jest niepomyślne.</p>
                `
            },
            {
                id: 6,
                title: "Przypadek 6: Ząb 15 - Przetrwały ból po leczeniu",
                description: "Pacjentka, 39 lat, zgłasza się z bólem zęba 15, który utrzymuje się mimo przeprowadzonego miesiąc temu leczenia kanałowego.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <circle cx="100" cy="100" r="20" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="85" cy="100" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="115" cy="100" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <path d="M115 100 L150 100" fill="none" stroke="#ddd" stroke-width="2" stroke-dasharray="2" />
                        <circle cx="160" cy="100" r="15" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="80" y="160" width="40" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="85" y="65" width="15" height="95" rx="1" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <rect x="115" y="65" width="15" height="95" rx="1" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <path d="M130 110 L150 110" fill="none" stroke="#ddd" stroke-width="2" stroke-dasharray="2" />
                        <circle cx="160" cy="110" r="10" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="85" y1="120" x2="115" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="85" y="130" width="30" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <line x1="125" y1="100" x2="145" y2="100" stroke="#999" stroke-width="3" />
                        <path d="M140 80 L160 100" fill="none" stroke="#ddd" stroke-width="2" stroke-dasharray="2" />
                        <circle cx="165" cy="105" r="10" fill="#ddd" stroke="#ccc" stroke-width="1" opacity="0.7" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Niewypełniony kanał boczny", correct: true },
                    { id: "d2", text: "Przepchnięte wypełnienie kanałowe", correct: false },
                    { id: "d3", text: "Perforacja korzenia", correct: false },
                    { id: "d4", text: "Przewlekłe zapalenie tkanek okołowierzchołkowych", correct: true },
                    { id: "d5", text: "Złamanie instrumentu endodontycznego", correct: false }
                ],
                findingsOptions: [
                    { id: "f1", text: "Rozrzedzenie kości w okolicy wierzchołka korzenia", correct: true },
                    { id: "f2", text: "Widoczny niewypełniony kanał boczny", correct: true },
                    { id: "f3", text: "Nadmiar materiału wypełniającego poza wierzchołkiem", correct: false },
                    { id: "f4", text: "Złamany instrument w kanale", correct: false },
                    { id: "f5", text: "Perforacja ściany korzenia", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Rewizja leczenia kanałowego", correct: true },
                    { id: "t2", text: "Leczenie chirurgiczne - resekcja wierzchołka", correct: true },
                    { id: "t3", text: "Ekstrakcja zęba", correct: false },
                    { id: "t4", text: "Antybiotykoterapia", correct: false },
                    { id: "t5", text: "Obserwacja i leczenie farmakologiczne", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia niewypełniony kanał boczny z przewlekłym zapaleniem tkanek okołowierzchołkowych.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Widoczny niewypełniony kanał boczny odchodzący od głównego kanału korzeniowego</li>
                        <li>Rozrzedzenie kości wokół wierzchołka korzenia wskazujące na przewlekły stan zapalny</li>
                        <li>Główne kanały są wypełnione prawidłowo</li>
                    </ul>
                    <p>Kanały boczne (dodatkowe) mogą być trudne do zidentyfikowania i wypełnienia podczas leczenia kanałowego. Jeśli pozostaną niewypełnione, mogą stanowić rezerwuar bakterii i prowadzić do przetrwałego zapalenia i bólu.</p>
                    <p>Dostępne są dwie główne opcje leczenia:</p>
                    <ul>
                        <li>Rewizja leczenia kanałowego - próba ponownego opracowania i wypełnienia kanału bocznego</li>
                        <li>Leczenie chirurgiczne (resekcja wierzchołka) - wskazane szczególnie gdy kanał boczny jest trudno dostępny od strony korony</li>
                    </ul>
                    <p>Wybór metody zależy od lokalizacji kanału bocznego, możliwości technicznych i preferencji pacjenta.</p>
                `
            },
            {
                id: 7,
                title: "Przypadek 7: Ząb 24 - Odsłonięcie miazgi",
                description: "Pacjent, 22 lata, zgłasza się z bólem zęba 24 po urazie. Widoczne jest punktowe odsłonięcie miazgi. Ząb reaguje na bodźce termiczne.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <circle cx="100" cy="100" r="20" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="100" cy="100" r="8" fill="#f99" stroke="#f77" stroke-width="1" />
                        <circle cx="100" cy="90" r="3" fill="#f00" stroke="#d00" stroke-width="1" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="80" y="160" width="40" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="90" y="70" width="20" height="90" rx="1" fill="#f99" stroke="#f77" stroke-width="1" />
                        <path d="M100 60 L100 40" fill="none" stroke="#f00" stroke-width="2" />
                        <circle cx="100" cy="30" r="3" fill="#f00" stroke="#d00" stroke-width="1" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="85" y1="120" x2="115" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="85" y="130" width="30" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <ellipse cx="100" cy="80" rx="15" ry="10" fill="#f99" stroke="#f77" stroke-width="1" />
                        <path d="M100 30 L100 50" fill="none" stroke="#f00" stroke-width="2" />
                        <circle cx="100" cy="55" r="3" fill="#f00" stroke="#d00" stroke-width="1" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Odwracalne zapalenie miazgi", correct: true },
                    { id: "d2", text: "Nieodwracalne zapalenie miazgi", correct: false },
                    { id: "d3", text: "Martwica miazgi", correct: false },
                    { id: "d4", text: "Próchnica głęboka", correct: false },
                    { id: "d5", text: "Złamanie korony z odsłonięciem miazgi", correct: true }
                ],
                findingsOptions: [
                    { id: "f1", text: "Punktowe odsłonięcie miazgi", correct: true },
                    { id: "f2", text: "Hiperemia miazgi", correct: true },
                    { id: "f3", text: "Rozrzedzenie kości w okolicy wierzchołka", correct: false },
                    { id: "f4", text: "Obliteracja kanału korzeniowego", correct: false },
                    { id: "f5", text: "Złamanie korzenia", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Bezpośrednie pokrycie miazgi", correct: true },
                    { id: "t2", text: "Częściowa pulpotomia (amputacja przyżyciowa)", correct: true },
                    { id: "t3", text: "Całkowite leczenie kanałowe", correct: false },
                    { id: "t4", text: "Ekstrakcja zęba", correct: false },
                    { id: "t5", text: "Obserwacja bez interwencji", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia złamanie korony z punktowym odsłonięciem miazgi i odwracalnym zapaleniem miazgi.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Punktowe odsłonięcie miazgi widoczne w obrazowaniu</li>
                        <li>Hiperemia (przekrwienie) miazgi - widoczna jako intensywniejszy kolor miazgi</li>
                        <li>Brak zmian w tkankach okołowierzchołkowych</li>
                        <li>Ząb reaguje na bodźce termiczne, co wskazuje na żywotność miazgi</li>
                    </ul>
                    <p>Przy świeżym urazie z niewielkim odsłonięciem miazgi u młodego pacjenta, leczenie zachowawcze ma szansę powodzenia.</p>
                    <p>Zalecanym postępowaniem jest:</p>
                    <ul>
                        <li>Bezpośrednie pokrycie miazgi materiałami na bazie wodorotlenku wapnia lub MTA (Mineral Trioxide Aggregate)</li>
                        <li>Lub częściowa pulpotomia, czyli usunięcie tylko powierzchownej, uszkodzonej warstwy miazgi</li>
                    </ul>
                    <p>Zabiegi te mają na celu zachowanie żywotności miazgi. Całkowite leczenie kanałowe byłoby zbyt radykalnym podejściem w tym przypadku.</p>
                `
            },
            {
                id: 8,
                title: "Przypadek 8: Ząb 26 - Objawy po leczeniu kanałowym",
                description: "Pacjentka, 51 lat, zgłasza się z bólem i obrzękiem policzka w okolicy zęba 26, który był leczony kanałowo 10 dni temu.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <path d="M70 70 Q100 40 130 70 Q160 100 130 130 Q100 160 70 130 Q40 100 70 70" fill="#777" stroke="#666" stroke-width="1" />
                        <path d="M80 80 Q100 60 120 80 Q140 100 120 120 Q100 140 80 120 Q60 100 80 80" fill="#ddd" stroke="#ccc" stroke-width="1" />
                        <path d="M50 100 L20 100" fill="none" stroke="#f66" stroke-width="5" />
                        <ellipse cx="60" cy="120" rx="25" ry="15" fill="#f99" stroke="#f77" stroke-width="1" opacity="0.5" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="60" y="160" width="80" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="70" y="60" width="60" height="70" rx="1" fill="#ddd" stroke="#ccc" stroke-width="1" />
                        <path d="M80 50 L60 30" fill="none" stroke="#f66" stroke-width="5" />
                        <ellipse cx="50" cy="20" rx="15" ry="10" fill="#f99" stroke="#f77" stroke-width="1" opacity="0.5" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="70" y1="120" x2="130" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="70" y="130" width="60" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <ellipse cx="100" cy="80" rx="30" ry="10" fill="#ddd" stroke="#ccc" stroke-width="1" />
                        <path d="M170 70 L130 70" fill="none" stroke="#f66" stroke-width="5" />
                        <ellipse cx="180" cy="70" rx="15" ry="25" fill="#f99" stroke="#f77" stroke-width="1" opacity="0.5" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Ostre zapalenie tkanek okołowierzchołkowych", correct: true },
                    { id: "d2", text: "Ropień okołowierzchołkowy", correct: true },
                    { id: "d3", text: "Przepchnięcie materiału wypełniającego", correct: false },
                    { id: "d4", text: "Perforacja korzenia", correct: false },
                    { id: "d5", text: "Zaostrzenie przewlekłego zapalenia tkanek okołowierzchołkowych", correct: true }
                ],
                findingsOptions: [
                    { id: "f1", text: "Obrzęk tkanek miękkich przylegających do zęba", correct: true },
                    { id: "f2", text: "Zatarcie granic anatomicznych w tkankach miękkich", correct: true },
                    { id: "f3", text: "Wypełnione kanały korzeniowe", correct: true },
                    { id: "f4", text: "Złamany instrument w kanale", correct: false },
                    { id: "f5", text: "Widoczna perforacja korzenia", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Nacięcie i drenaż", correct: true },
                    { id: "t2", text: "Antybiotykoterapia", correct: true },
                    { id: "t3", text: "Rewizja leczenia kanałowego", correct: false },
                    { id: "t4", text: "Ekstrakcja zęba", correct: false },
                    { id: "t5", text: "Obserwacja bez interwencji", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia zaostrzenie przewlekłego zapalenia tkanek okołowierzchołkowych z ostrym zapaleniem i ropniem.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Widoczny obrzęk tkanek miękkich w okolicy zęba</li>
                        <li>Zatarcie granic anatomicznych w tkankach miękkich wskazujące na stan zapalny</li>
                        <li>Wypełnione kanały korzeniowe bez widocznych nieprawidłowości technicznych</li>
                        <li>Wystąpienie objawów krótko po leczeniu kanałowym</li>
                    </ul>
                    <p>Po leczeniu kanałowym może dojść do zaostrzenia stanu zapalnego z powodu:</p>
                    <ul>
                        <li>Przejściowego podrażnienia tkanek okołowierzchołkowych podczas instrumentacji</li>
                        <li>Przemieszczenia bakterii poza wierzchołek korzenia</li>
                        <li>Reakcji immunologicznej na materiały wypełniające</li>
                    </ul>
                    <p>Leczenie obejmuje:</p>
                    <ul>
                        <li>Nacięcie i drenaż w przypadku ropnia, aby zmniejszyć ciśnienie i ułatwić odpływ wydzieliny ropnej</li>
                        <li>Antybiotykoterapię, szczególnie przy objawach ogólnoustrojowych lub rozległym obrzęku</li>
                        <li>Leki przeciwbólowe i przeciwzapalne</li>
                    </ul>
                    <p>Rewizja leczenia kanałowego zwykle nie jest konieczna, jeśli zostało ono wykonane prawidłowo. Stan zapalny powinien ustąpić w ciągu kilku dni.</p>
                `
            },
            {
                id: 9,
                title: "Przypadek 9: Ząb 37 - Resorpcja zewnętrzna",
                description: "Pacjent, 40 lat, zgłasza się na rutynowy przegląd. Podczas badania CBCT wykryto zmiany w korzeniu zęba 37, który jest bezobjawowy.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <path d="M70 70 Q100 40 130 70 Q160 100 130 130 Q100 160 70 130 Q40 100 70 70" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="85" cy="85" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="115" cy="85" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="85" cy="115" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <circle cx="115" cy="115" r="8" fill="#ddd" stroke="#aaa" stroke-width="1" />
                        <path d="M130 100 Q135 105 130 110" fill="none" stroke="#777" stroke-width="1" stroke-dasharray="2" />
                        <path d="M140 100 Q145 105 140 110" fill="none" stroke="#999" stroke-width="1" stroke-dasharray="2" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="60" y="160" width="80" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="70" y="60" width="60" height="70" rx="1" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <path d="M100 110 Q130 120 100 130" fill="none" stroke="#777" stroke-width="1" stroke-dasharray="2" />
                        <path d="M100 120 Q110 120 100 130" fill="#999" stroke="#888" stroke-width="1" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="50" y="30" width="100" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="60" y="60" width="80" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="70" y1="120" x2="130" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="70" y="130" width="60" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <ellipse cx="100" cy="80" rx="30" ry="10" fill="#bbb" stroke="#aaa" stroke-width="1" />
                        <path d="M120 120 Q110 130 120 140" fill="#999" stroke="#888" stroke-width="1" />
                        <path d="M120 125 Q110 130 120 135" fill="none" stroke="#777" stroke-width="1" stroke-dasharray="2" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Resorpcja zewnętrzna korzenia", correct: true },
                    { id: "d2", text: "Resorpcja wewnętrzna korzenia", correct: false },
                    { id: "d3", text: "Próchnica korzenia", correct: false },
                    { id: "d4", text: "Pionowe złamanie korzenia", correct: false },
                    { id: "d5", text: "Ankyloza zęba", correct: false }
                ],
                findingsOptions: [
                    { id: "f1", text: "Ubytek tkanki korzenia od strony zewnętrznej", correct: true },
                    { id: "f2", text: "Nieregularny kształt kanału korzeniowego", correct: false },
                    { id: "f3", text: "Zatarcie granic ozębnej", correct: true },
                    { id: "f4", text: "Linia złamania w korzeniu", correct: false },
                    { id: "f5", text: "Poszerzony kanał korzeniowy", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Leczenie zachowawcze - obserwacja", correct: true },
                    { id: "t2", text: "Leczenie kanałowe z wypełnieniem ubytku MTA", correct: true },
                    { id: "t3", text: "Ekstrakcja zęba", correct: false },
                    { id: "t4", text: "Rewizja leczenia kanałowego", correct: false },
                    { id: "t5", text: "Chirurgiczne usunięcie zmiany", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia resorpcję zewnętrzną korzenia.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Ubytek tkanki korzenia widoczny od strony zewnętrznej</li>
                        <li>Zatarcie granic ozębnej w miejscu resorpcji</li>
                        <li>Kanał korzeniowy ma prawidłowy, regularny kształt (w przeciwieństwie do resorpcji wewnętrznej)</li>
                    </ul>
                    <p>Resorpcja zewnętrzna może być spowodowana:</p>
                    <ul>
                        <li>Urazem zęba</li>
                        <li>Przewlekłym zapaleniem przyzębia</li>
                        <li>Ortodontycznym przemieszczaniem zębów</li>
                        <li>Naciskiem z sąsiednich struktur</li>
                    </ul>
                    <p>Leczenie zależy od zasięgu resorpcji i objawów:</p>
                    <ul>
                        <li>W przypadku niewielkiej, bezobjawowej resorpcji - obserwacja</li>
                        <li>Jeśli resorpcja sięga do kanału - leczenie kanałowe z wypełnieniem ubytku materiałem biokompatybilnym (np. MTA)</li>
                        <li>Tylko w zaawansowanych przypadkach konieczna jest ekstrakcja</li>
                    </ul>
                    <p>Ponieważ ząb jest bezobjawowy, a zmiana niewielka, odpowiednim postępowaniem jest regularna obserwacja lub leczenie kanałowe z zamknięciem ubytku resorpcyjnego.</p>
                `
            },
            {
                id: 10,
                title: "Przypadek 10: Ząb 22 - Zmiany po urazie",
                description: "Pacjent, 15 lat, zgłasza się po urazie zęba 22, który miał miejsce 3 dni temu. Ząb jest nieco ruchomy, korona nie ma widocznych uszkodzeń.",
                axialSvg: `
                    <svg viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="70" fill="#999" stroke="#777" stroke-width="1" />
                        <circle cx="100" cy="100" r="15" fill="#777" stroke="#666" stroke-width="1" />
                        <circle cx="100" cy="100" r="6" fill="#f99" stroke="#f77" stroke-width="1" />
                        <path d="M80 90 L120 110" fill="none" stroke="#f00" stroke-width="1" />
                        <path d="M80 110 L120 90" fill="none" stroke="#f00" stroke-width="1" />
                    </svg>
                `,
                sagittalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="100" y1="60" x2="100" y2="160" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="80" y="160" width="40" height="20" rx="2" fill="#999" stroke="#888" stroke-width="1" />
                        <rect x="90" y="70" width="20" height="90" rx="1" fill="#f99" stroke="#f77" stroke-width="1" />
                        <path d="M80 110 L120 110" fill="none" stroke="#f00" stroke-width="1" />
                        <path d="M95 160 L105 180" fill="none" stroke="#bbb" stroke-width="2" stroke-dasharray="2" />
                    </svg>
                `,
                coronalSvg: `
                    <svg viewBox="0 0 200 200">
                        <rect x="70" y="30" width="60" height="30" rx="5" fill="#444" stroke="#333" stroke-width="1" />
                        <rect x="80" y="60" width="40" height="100" rx="2" fill="#777" stroke="#666" stroke-width="1" />
                        <line x1="85" y1="120" x2="115" y2="120" stroke="#666" stroke-width="1" stroke-dasharray="2" />
                        <rect x="85" y="130" width="30" height="30" rx="1" fill="#999" stroke="#888" stroke-width="1" />
                        <ellipse cx="100" cy="80" rx="15" ry="10" fill="#f99" stroke="#f77" stroke-width="1" />
                        <path d="M80 110 L120 110" fill="none" stroke="#f00" stroke-width="1" />
                        <path d="M90 160 L110 160" fill="none" stroke="#f00" stroke-width="1" />
                    </svg>
                `,
                diagnosisOptions: [
                    { id: "d1", text: "Złamanie poziome korzenia", correct: true },
                    { id: "d2", text: "Złamanie pionowe korzenia", correct: false },
                    { id: "d3", text: "Zwichnięcie zęba", correct: true },
                    { id: "d4", text: "Wstrząśnienie zęba", correct: false },
                    { id: "d5", text: "Złamanie korony zęba", correct: false }
                ],
                findingsOptions: [
                    { id: "f1", text: "Linia złamania w środkowej części korzenia", correct: true },
                    { id: "f2", text: "Poszerzenie szpary ozębnej", correct: true },
                    { id: "f3", text: "Przemieszczenie fragmentów korzenia", correct: false },
                    { id: "f4", text: "Złamanie wyrostka zębodołowego", correct: false },
                    { id: "f5", text: "Złamanie korony zęba", correct: false }
                ],
                treatmentOptions: [
                    { id: "t1", text: "Szynowanie zęba", correct: true },
                    { id: "t2", text: "Natychmiastowe leczenie kanałowe", correct: false },
                    { id: "t3", text: "Obserwacja i kontrola żywotności miazgi", correct: true },
                    { id: "t4", text: "Ekstrakcja zęba", correct: false },
                    { id: "t5", text: "Repozycja i szynowanie", correct: false }
                ],
                feedback: `
                    <p>Ten przypadek przedstawia złamanie poziome korzenia (złamanie poprzeczne) z towarzyszącym zwichnięciem zęba.</p>
                    <p>Kluczowe obserwacje:</p>
                    <ul>
                        <li>Wyraźna linia złamania przebiegająca poziomo w środkowej części korzenia</li>
                        <li>Poszerzenie szpary ozębnej wskazujące na zwichnięcie zęba</li>
                        <li>Brak znacznego przemieszczenia fragmentów korzenia</li>
                    </ul>
                    <p>Złamania poziome korzenia mają stosunkowo dobre rokowanie, szczególnie u młodych pacjentów. Gojenie może przebiegać na kilka sposobów:</p>
                    <ul>
                        <li>Poprzez wytworzenie tkanki twardej (zębiny i cementu)</li>
                        <li>Poprzez wytworzenie tkanki łącznej</li>
                        <li>Poprzez wytworzenie tkanki kostnej i łącznej</li>
                        <li>Przez wytworzenie ziarniny zapalnej (niepomyślne rokowanie)</li>
                    </ul>
                    <p>Zalecanym leczeniem jest:</p>
                    <ul>
                        <li>Szynowanie zęba na okres 4 tygodni, aby ustabilizować odłamy</li>
                        <li>Regularna kontrola żywotności miazgi - leczenie kanałowe należy wdrożyć tylko w przypadku martwicy miazgi</li>
                        <li>Długoterminowa obserwacja - nawet do kilku lat</li>
                    </ul>
                    <p>Natychmiastowe leczenie kanałowe nie jest wskazane, ponieważ miazga może zachować żywotność, szczególnie u młodych pacjentów.</p>
                `
            }
        ];
        
        // Zmienne globalne
        let currentCaseIndex = 0;
        let answeredCases = [];
        let userScore = 0;
        
        // Elementy DOM
        const welcomeScreen = document.getElementById('welcome-screen');
        const gameScreen = document.getElementById('game-screen');
        const resultsScreen = document.getElementById('results-screen');
        const progressBar = document.getElementById('progress-bar');
        const caseTitle = document.getElementById('case-title');
        const caseDescription = document.getElementById('case-description');
        const axialSvgContainer = document.getElementById('axial-svg-container');
        const sagittalSvgContainer = document.getElementById('sagittal-svg-container');
        const coronalSvgContainer = document.getElementById('coronal-svg-container');
        const diagnosisOptions = document.getElementById('diagnosis-options');
        const findingsOptions = document.getElementById('findings-options');
        const treatmentOptions = document.getElementById('treatment-options');
        const feedback = document.getElementById('feedback');
        const feedbackContent = document.getElementById('feedback-content');
        const finalScore = document.getElementById('final-score');
        const casesSummary = document.getElementById('cases-summary');
        
        // Przyciski
        const startGameBtn = document.getElementById('start-game');
        const submitAnswerBtn = document.getElementById('submit-answer');
        const nextCaseBtn = document.getElementById('next-case');
        const restartGameBtn = document.getElementById('restart-game');
        const viewAllBtn = document.getElementById('view-all');
        const viewAxialBtn = document.getElementById('view-axial');
        const viewSagittalBtn = document.getElementById('view-sagittal');
        const viewCoronalBtn = document.getElementById('view-coronal');
        
        // Widoki CBCT
        const axialView = document.getElementById('axial-view');
        const sagittalView = document.getElementById('sagittal-view');
        const coronalView = document.getElementById('coronal-view');
        
        // Funkcje pomocnicze
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        function createCheckboxOptions(options, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            options.forEach(option => {
                const div = document.createElement('div');
                div.className = 'option';
                
                const input = document.createElement('input');
                input.type = 'checkbox';
                input.id = option.id;
                input.name = containerId;
                
                const label = document.createElement('label');
                label.htmlFor = option.id;
                label.textContent = option.text;
                
                div.appendChild(input);
                div.appendChild(label);
                container.appendChild(div);
            });
        }
        
        function loadCase(caseIndex) {
    const currentCase = cases[caseIndex];
    
    // Aktualizacja informacji o przypadku
    caseTitle.textContent = currentCase.title;
    caseDescription.textContent = currentCase.description;
    
    // Wczytanie obrazów SVG
    axialSvgContainer.innerHTML = currentCase.axialSvg;
    sagittalSvgContainer.innerHTML = currentCase.sagittalSvg;
    coronalSvgContainer.innerHTML = currentCase.coronalSvg;
    
    // Utwórz opcje diagnozy, obserwacji i leczenia
    createCheckboxOptions(shuffleArray([...currentCase.diagnosisOptions]), 'diagnosis-options');
    createCheckboxOptions(shuffleArray([...currentCase.findingsOptions]), 'findings-options');
    createCheckboxOptions(shuffleArray([...currentCase.treatmentOptions]), 'treatment-options');
    
    // Aktualizacja paska postępu
    progressBar.style.width = `${((caseIndex + 1) / cases.length) * 100}%`;
    
    // Ukryj informację zwrotną
    feedback.style.display = 'none';
    
    // Aktywuj przycisk widoku całościowego
    setActiveViewButton(viewAllBtn);
    showAllViews();
}

function checkAnswers() {
    const currentCase = cases[currentCaseIndex];
    let correctCount = 0;
    let totalCorrect = 0;
    
    // Sprawdź diagnozę
    currentCase.diagnosisOptions.forEach(option => {
        const checkbox = document.getElementById(option.id);
        if ((checkbox.checked && option.correct) || (!checkbox.checked && !option.correct)) {
            correctCount++;
        }
        if (option.correct) {
            totalCorrect++;
            
            // Dodaj klasę dla poprawnych odpowiedzi
            if (checkbox.checked) {
                checkbox.parentElement.classList.add('correct');
            } else {
                checkbox.parentElement.classList.add('incorrect');
            }
        } else {
            // Dodaj klasę dla niepoprawnych odpowiedzi
            if (checkbox.checked) {
                checkbox.parentElement.classList.add('incorrect');
            }
        }
        
        // Wyłącz checkbox po sprawdzeniu
        checkbox.disabled = true;
    });
    
    // Sprawdź obserwacje
    currentCase.findingsOptions.forEach(option => {
        const checkbox = document.getElementById(option.id);
        if ((checkbox.checked && option.correct) || (!checkbox.checked && !option.correct)) {
            correctCount++;
        }
        if (option.correct) {
            totalCorrect++;
            
            // Dodaj klasę dla poprawnych odpowiedzi
            if (checkbox.checked) {
                checkbox.parentElement.classList.add('correct');
            } else {
                checkbox.parentElement.classList.add('incorrect');
            }
        } else {
            // Dodaj klasę dla niepoprawnych odpowiedzi
            if (checkbox.checked) {
                checkbox.parentElement.classList.add('incorrect');
            }
        }
        
        // Wyłącz checkbox po sprawdzeniu
        checkbox.disabled = true;
    });
    
    // Sprawdź leczenie
    currentCase.treatmentOptions.forEach(option => {
        const checkbox = document.getElementById(option.id);
        if ((checkbox.checked && option.correct) || (!checkbox.checked && !option.correct)) {
            correctCount++;
        }
        if (option.correct) {
            totalCorrect++;
            
            // Dodaj klasę dla poprawnych odpowiedzi
            if (checkbox.checked) {
                checkbox.parentElement.classList.add('correct');
            } else {
                checkbox.parentElement.classList.add('incorrect');
            }
        } else {
            // Dodaj klasę dla niepoprawnych odpowiedzi
            if (checkbox.checked) {
                checkbox.parentElement.classList.add('incorrect');
            }
        }
        
        // Wyłącz checkbox po sprawdzeniu
        checkbox.disabled = true;
    });
    
    // Oblicz wynik
    const totalOptions = currentCase.diagnosisOptions.length + currentCase.findingsOptions.length + currentCase.treatmentOptions.length;
    const score = Math.round((correctCount / totalOptions) * 100);
    
    // Zapisz wynik
    answeredCases.push({
        caseId: currentCase.id,
        caseTitle: currentCase.title,
        score: score,
        correctAnswers: correctCount,
        totalOptions: totalOptions,
        correctRequired: totalCorrect
    });
    
    // Zwiększ całkowity wynik
    userScore += score;
    
    // Wyświetl informację zwrotną
    feedbackContent.innerHTML = currentCase.feedback;
    feedback.style.display = 'block';
    
    // Wyłącz przycisk zatwierdzania
    submitAnswerBtn.disabled = true;
}

function nextCase() {
    currentCaseIndex++;
    
    if (currentCaseIndex < cases.length) {
        loadCase(currentCaseIndex);
        submitAnswerBtn.disabled = false;
    } else {
        showResults();
    }
}

function showResults() {
    // Ukryj ekran gry i pokaż wyniki
    gameScreen.classList.remove('active');
    resultsScreen.classList.add('active');
    
    // Oblicz średni wynik
    const averageScore = Math.round(userScore / answeredCases.length);
    finalScore.textContent = `Wynik: ${averageScore}%`;
    
    // Wyczyść i wypełnij podsumowanie przypadków
    casesSummary.innerHTML = '';
    answeredCases.forEach(caseResult => {
        const li = document.createElement('li');
        li.innerHTML = `${caseResult.caseTitle}: <span>${caseResult.score}%</span> (${caseResult.correctAnswers}/${caseResult.totalOptions} poprawnych odpowiedzi)`;
        casesSummary.appendChild(li);
    });
}

function restartGame() {
    // Resetuj zmienne
    currentCaseIndex = 0;
    answeredCases = [];
    userScore = 0;
    
    // Ukryj ekran wyników i pokaż ekran gry
    resultsScreen.classList.remove('active');
    gameScreen.classList.add('active');
    
    // Załaduj pierwszy przypadek
    loadCase(currentCaseIndex);
    submitAnswerBtn.disabled = false;
}

function showAllViews() {
    axialView.style.display = 'block';
    sagittalView.style.display = 'block';
    coronalView.style.display = 'block';
}

function showOnlyAxialView() {
    axialView.style.display = 'block';
    sagittalView.style.display = 'none';
    coronalView.style.display = 'none';
}

function showOnlySagittalView() {
    axialView.style.display = 'none';
    sagittalView.style.display = 'block';
    coronalView.style.display = 'none';
}

function showOnlyCoronalView() {
    axialView.style.display = 'none';
    sagittalView.style.display = 'none';
    coronalView.style.display = 'block';
}

function setActiveViewButton(button) {
    [viewAllBtn, viewAxialBtn, viewSagittalBtn, viewCoronalBtn].forEach(btn => {
        btn.classList.remove('active');
    });
    button.classList.add('active');
}

// Event listenery
startGameBtn.addEventListener('click', () => {
    welcomeScreen.classList.remove('active');
    gameScreen.classList.add('active');
    loadCase(currentCaseIndex);
});

submitAnswerBtn.addEventListener('click', checkAnswers);
nextCaseBtn.addEventListener('click', nextCase);
restartGameBtn.addEventListener('click', restartGame);

viewAllBtn.addEventListener('click', () => {
    setActiveViewButton(viewAllBtn);
    showAllViews();
});

viewAxialBtn.addEventListener('click', () => {
    setActiveViewButton(viewAxialBtn);
    showOnlyAxialView();
});

viewSagittalBtn.addEventListener('click', () => {
    setActiveViewButton(viewSagittalBtn);
    showOnlySagittalView();
});

viewCoronalBtn.addEventListener('click', () => {
    setActiveViewButton(viewCoronalBtn);
    showOnlyCoronalView();
});

// Losowe ułożenie kolejności przypadków
shuffleArray(cases);

// Automatyczne ładowanie pierwszego ekranu
document.addEventListener('DOMContentLoaded', () => {
    welcomeScreen.classList.add('active');
});
    </script>
</body>
</html>